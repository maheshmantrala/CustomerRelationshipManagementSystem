package com.mahesh.capstone.Controller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import com.mahesh.capstone.DTO.CustomerDto;
import com.mahesh.capstone.DTO.InteractionDto;
import com.mahesh.capstone.Service.InteractionService;
import com.mahesh.capstone.entity.Interaction;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

@RestController
@CrossOrigin(origins = "http://localhost:4200")
@RequestMapping("/interactions")
public class InteractionController {

    @Autowired
    private InteractionService interactionService;

    @GetMapping("/{id}")
    public ResponseEntity<InteractionDto> getInteractionById(@PathVariable Long id) {
        return ResponseEntity.ok(interactionService.getInteractionById(id));
    }

    @GetMapping("/getall")
    public ResponseEntity<List<InteractionDto>> getAllInteractions() {
        return ResponseEntity.ok(interactionService.getAllInteractions());
    }

    @PostMapping("/add")
    public ResponseEntity<InteractionDto> createInteraction(@RequestBody InteractionDto interactionDto) {
        return ResponseEntity.ok(interactionService.createInteraction(interactionDto));
    }

    @DeleteMapping("/{id}")
    public ResponseEntity<Void> deleteInteraction(@PathVariable Long id) {
        interactionService.deleteInteraction(id);
        return ResponseEntity.noContent().build();
    }
    
    @GetMapping("/interaction/customer/{id}")
    public Map<String, Object> getCustomerWithInteractions(@PathVariable Long id) {
        CustomerDto customer = interactionService.getCustomerInfo(id);
        List<Interaction> interactions1 = interactionService.getInteractionsByCustomerId(id);

        Map<String, Object> response = new HashMap<>();
        response.put("customer", customer);
        response.put("interactions", interactions1);

        return response;
    }
    
 
}



































































































































































































































    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

